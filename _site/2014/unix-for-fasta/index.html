<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Unix for fasta | Notes </title> <meta name="description" content=" Microbes + Biogeochemistry "> <meta name="keywords" content="Marine, microbial ecology, bacteria, biogeochemistry, ocean"> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <!-- Social: Facebook / Open Graph --> <meta property="og:type" content="article"> <meta property="article:author" content="Shane Hogle"> <meta property="article:section" content="bioinformatics_notebook"> <meta property="article:tag" content=""> <meta property="article:published_time" content="2014-04-14 00:00:00 -0400"> <meta property="og:url" content="//2014/unix-for-fasta/"> <meta property="og:title" content=" Unix for fasta | Notes "> <meta property="og:image" content="/"> <meta property="og:description" content=" Microbes + Biogeochemistry "> <meta property="og:site_name" content="Shane Hogle"> <meta property="og:locale" content="en_US"> <!-- Social: Twitter --> <meta name="twitter:card" content="summary_large_image"> <meta name="twitter:site" content="@Hslhogle"> <meta name="twitter:title" content=" Unix for fasta | Notes "> <meta name="twitter:description" content=" Microbes + Biogeochemistry "> <meta name="twitter:image:src" content="/"> <!-- Social: Google+ / Schema.org --> <meta itemprop="name" content=" Unix for fasta | Notes "> <meta itemprop="description" content=" Microbes + Biogeochemistry "> <meta itemprop="image" content="/"> <!-- rel prev and next --> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="stylesheet" href="/assets/css/font-awesome.min.css"> <!-- Canonical link tag --> <link rel="canonical" href="//2014/unix-for-fasta/"> <link rel="alternate" type="application/rss+xml" title="Notes" href="//feed.xml"> <script type="text/javascript"> var disqus_shortname = 'slhogle-site'; var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-XXXXX-XX']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </head> <body> <main class="wrapper"> <header class="site-header"> <nav class="nav"> <div class="container"> <h1 class="logo"><a href="/">Notes<span></span></a></h1> <ul class="navbar"> <li><a href="/about">about</a></li> <li><a href="/research">research</a></li> <li><a href="/publications">publications</a></li> <li><a href="/contact">contact</a></li> </ul> </div> </nav> </header> <article class="post container" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <p class="post-meta"><time datetime="2014-04-14T00:00:00-04:00" itemprop="datePublished">Apr 14, 2014</time></p> <h1 class="post-title" itemprop="name headline">Unix for fasta</h1> </header> <div class="post-content" itemprop="articleBody"> <p>The syntax here is using the Bash shell in unix.</p> <table> <tbody> <tr> <td>The following command counts the number of sequences in a fasta formatted file. The “</td> <td>” operator is a pipe. This lets you stream the output from one command into another.</td> </tr> </tbody> </table> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">grep <span class="s2">"&gt;"</span> YOURFILE.fasta | wc -l</code></pre></figure> <p>Extract position 2 through 8 on all sequences in a fasta file. The -v option for grep is the inversion option. This tells grep to only consider lines that are not fasta headers.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">grep -v <span class="s2">"&gt;"</span> YOURFILE.fasta | cut -c2-8 &gt; YOURFILE_pos2-8.fasta</code></pre></figure> <p>Counts how many unique text strings are in a file.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">sort -u YOURFILE_pos2-8.fasta | wc -l</code></pre></figure> <p>Exports counts of unique occurences in YOURFILE_pos2-8.fasta</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">sort YOURFILE_pos2-8.fasta | uniq -c &gt; YOURFILE_unique_counts.output</code></pre></figure> <p>This series of commands will format YOURFILE_unique_counts.output to remove the leading whitespace and replace the remaining whitespace with a tab character “/t” It then will sort this in decreasing numerical order.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">sed <span class="s1">'s/^\s\+//'</span> YOURFILE_unique_counts.output | sed <span class="s1">'s/\s\+/\t/'</span> | sort -n -r</code></pre></figure> <p><strong>Example questions: Use “grep”, “cat”, “sort”, and “uniq -c” to extract microRNA sequences from <a href="./v19.fa">mirbase Version 19</a> and <a href="./v20.fa">Version 20</a> and determine which sequences are in both versions. How many are shared in both versions?</strong></p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">grep -v <span class="s2">"&gt;"</span> v19.fa | sort -u &gt; v19_uniq.out
grep -v <span class="s2">"&gt;"</span> v20.fa | sort -u &gt; v20_uniq.out</code></pre></figure> <p>This creates a file (v19_uniq.out) with only unique nucleic acid sequences. The “&gt;” operator at the end of a command writes the output to a file (in this case v19_uniq.out) instead of to the screen of the terminal. So now we have both versions of mirbase with only unique sequences - no duplicates - in two different files.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">cat v19_uniq.out v20_uniq.out | sort | uniq -c | grep -c <span class="s2">"2"</span></code></pre></figure> <p>The cat command merges the content of files or standard input and outputs to the terminal. So with the first command we combine all unique sequences in each database. We then pipe that output to the sort command which orders the sequences alphanumerically. We pipe that output to uniq -c, which as we saw above counts the number of occurences of a given text string. Now my logic for using a pipe then grep -c “2” is that any sequence that occurs in both version 19 and 20 of mirbase will have a count of 2. (The -c operator can be used with grep to count the number of occurences of a text string or regular expression) If a sequences is unique to either database it will have a count of 1. By counting the number of occurences of 2 we find how many sequences were in both databases. My answer was 13522 sequences.</p> <p><strong>Example questions: Use “grep” and “sort” to extract microRNA sequences from mirbase Version 19 and Version 20, creating 2 intermediate files. Use “join” to generate sequences present only in Version 19, only in Version 20, and both versions. How many sequences are in each of the 3 output files?</strong></p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">join -v 1 v19_uniq.out v20_uniq.out | wc -l
join -v 2 v19_uniq.out v20_uniq.out | wc -l</code></pre></figure> <p>Here I used the same files (v20_uniq.out and v19_uniq.out) generated from the previous question. The trick to using join is that your input files must be sorted prior to use. Using the -v X operator tells join to output the lines that are unique to file X. In the way the files are ordered above, -v 1 tells join to ouput only the sequences unique to v19. Using the pipe operator plus wc -l gets the number lines from the join output. So we see that there were 80 unique sequences in mirbase version 19 that were “retired” from the version 20 issue of the database. Likewise, we see that 2204 unique sequences were added to version 20. If you were to use the -a 1 option this would output the shared sequences between the two databases plus the “unmatchable” ones in version 19. Substracting 80 from this number gives you the number of unique sequences shared in both versions.</p> <aside class="share"> <p>Share this post on <a href="http://twitter.com/share?text=Unix for fasta&amp;url=//2014/unix-for-fasta/&amp;via=slhogle" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">Twitter <i class="fa fa-twitter" aria-hidden="true" style="color:#00aced"></i></a> </p> </aside> </div> </article> <!-- // <aside id="comments" class="disqus"> <div class="container"> <h3><i class="icon icon-comments-o"></i> Comments</h3> <div id="disqus_thread"></div> <script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */ var disqus_config = function () { this.page.url = "http://slhogle.github.io/"; // Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable }; (function() { // DON'T EDIT BELOW THIS LINE var d = document, s = d.createElement('script'); s.src = '//slhogle-site.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript> </div> </aside> --> <footer class="site-footer"> <div class="container"> <div align="center"> <small class="block">&copy; 2016 Shane Hogle. All rights reserved.</small> </div> </div> </footer> </main> </body> </html>
